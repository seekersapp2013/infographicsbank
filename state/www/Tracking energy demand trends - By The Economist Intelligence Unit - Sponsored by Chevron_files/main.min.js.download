/*! 2018-12-20 */

!function(a,b,c){function d(c,d,e,f){var g=13,h=2*Math.PI/f,i=0,j="",k=0;j+='<svg id="js-national-chart-disc" class="national-chart-disc" width="600" height="600">',j+='<circle cx="'+c.toString()+'" cy="'+d.toString()+'" r="'+e.toString()+'" fill="#FFFFFF"/>',j+='<g class="states">';for(var l=0;l<f;l++){var m=(e-.5)*Math.sin(i)+c,n=(e-.5)*-Math.cos(i)+d,o=Math.cos(i),p=Math.sin(i),q=-1*-Math.sin(i),r=-1*Math.cos(i);j+="<g"+(0===k?' class="current"':"")+' data-state="'+Object.keys(a.states)[k]+'" title="'+a.states[Object.keys(a.states)[k]].name+'">',j+='<rect x="0" y="0" transform="matrix('+o.toString()+", "+p.toString()+", "+q.toString()+", "+r.toString()+", "+m.toString()+", "+n.toString()+')" width="18" height="0" fill="black"/>';var s=57.3248408*i-90,t=s/57.3248408,u=e*Math.sin(i),v=e*-Math.cos(i),w=u*Math.cos(t)+v*Math.sin(t)-8,x=u*-Math.sin(t)+v*Math.cos(t);j+='<text x="'+(w+c).toString()+'" y="'+(x+d).toString()+'" dy="'+g.toString()+'" transform="rotate('+s.toString()+' 300, 300)" text-anchor="end">'+Object.keys(a.states)[k]+"</text>",j+="</g>",i+=h,k++}j+="</g></svg>",b("#js-national-chart").prepend(j),b(".states > g","#js-national-chart-disc").tooltipster({plugins:["laa.follower"]})}function e(c){var d=510,e=200,f=72;a.window.width()<768&&(d=305,e=115,f=50),a.energyChartData=[["data1",a.data[a.states[a.state].name.toUpperCase()]["per-source"][a.year].s_1],["data2",a.data[a.states[a.state].name.toUpperCase()]["per-source"][a.year].s_2],["data3",a.data[a.states[a.state].name.toUpperCase()]["per-source"][a.year].s_3],["data4",a.data[a.states[a.state].name.toUpperCase()]["per-source"][a.year].s_4],["data5",a.data[a.states[a.state].name.toUpperCase()]["per-source"][a.year].s_5]],b("svg",c).length?a.energyChart.load({columns:a.energyChartData}):a.energyChart=c3.generate({data:{columns:a.energyChartData,colors:{data1:"#699bac",data2:"#f4eddc",data3:"#7F7F7F",data4:"#3b7979",data5:"#abdddc"},order:null,type:"donut"},donut:{label:{format:function(a,b,c){return u(a)},threshold:.015},width:f},size:{height:d,width:d},interaction:{enabled:!1},bindto:c,legend:{show:!1},grid:{x:{show:!1}},transition:{duration:500},axis:{x:{show:!1},y:{show:!1},y2:{show:!1}},onrendered:function(){b("#js-section-energy").is(":visible")&&(d3.selectAll(".c3-chart-arc>text").attr("transform",function(a,b){var c=e,d=(a.startAngle+a.endAngle)/2-Math.PI/2;return"translate("+Math.cos(d)*c+","+Math.sin(d)*c+")"}),b("#js-energy-chart .c3-arcs-data1").attr("title",a.energyChartData[0][1]),b("#js-energy-chart .c3-arcs-data2").attr("title",a.energyChartData[1][1]),b("#js-energy-chart .c3-arcs-data3").attr("title",a.energyChartData[2][1]),b("#js-energy-chart .c3-arcs-data4").attr("title",a.energyChartData[3][1]),b("#js-energy-chart .c3-arcs-data5").attr("title",a.energyChartData[4][1]),b("#js-energy-chart .tooltipstered").tooltipster("destroy"),b("#js-energy-chart .c3-arcs").not(".tooltipstered").each(function(){var a=b(this);""===a.next("text").html()&&a.tooltipster({plugins:["laa.follower"]})}))}})}function f(){var c="",d="",e=b("#js-state-links-template").html().replace(new RegExp(",","g"),""),f="",g="",h=b("#js-select-state-template").html().replace(new RegExp(",","g"),"");for(var i in a.states)d=e,d=d.replace(new RegExp("{key}","g"),i),c+=d,g=h,g=g.replace(new RegExp("{key}","g"),i),g=g.replace(new RegExp("{name}","g"),a.states[i].name),f+=g;b("#js-state-links").html(c),b("#js-select-state").html(f)}function g(){var c="",d="",e=b("#js-select-sector-template").html().replace(new RegExp(",","g"),"");for(var f in a.labels)new RegExp("^s_").test(f)&&(d=e,d=d.replace(new RegExp("{key}","g"),f),d=d.replace(new RegExp("{name}","g"),("s_0"===f?"":"- ")+a.labels[f]),c+=d);b("#js-select-sector").html(c),b('option[value="'+a.sector+'"]',"#js-select-sector").prop("selected",!0)}function h(){var c=1,d="",e="",f=b("#js-energy-chart-legend-template").html().replace(new RegExp(",","g"),"");for(var g in a.labels)new RegExp("^s_[^0]").test(g)&&(e=f,e=e.replace(new RegExp("{key}","g"),c),e=e.replace(new RegExp("{label}","g"),a.labels[g]),d+=e,c++);b("#js-energy-chart-legend").html(d)}function i(){var c="";c=b("#js-site-socials-template").html().replace(new RegExp(",","g"),""),c=c.replace(new RegExp("{state}","g"),a.getCurrentState()),c=c.replace(new RegExp("{section}","g"),a.getCurrentSection()),b("#js-site-socials").html(c),b("#ga-share-title").val(a.states[a.state].name+" - "+a.sections[a.getCurrentSection()])}function j(){var a=r(),c="",d="",e=b("#js-years-template").html().replace(new RegExp(",","g"),"");for(var f in a.reverse())d=e,d=d.replace(new RegExp("{year}","g"),a[f]),c+=d;b(".js-years").html(c)}function k(){var c=[],d=[],e=0,f=r();for(var g in a.data){c.push(Math.ceil(a.data[g]["per-source"][a.year][a.sector]));for(var h in f)d.push(Math.ceil(a.data[g]["per-source"][f[h]][a.sector]))}e=Math.max.apply(Math,d);var i=0;b("#js-national-chart rect").each(function(){b(this).css({height:Math.ceil(c[i]/e*100)+"px"}).attr("height",Math.ceil(c[i]/e*100)+"px"),i++})}function l(){var c=a.national.NATIONAL["per-capita"][a.year],d=a.data[a.states[a.state].name.toUpperCase()]["per-capita"][a.year],e=new CountUp("js-energy-national-percap",b("#js-energy-national-percap").html().replace(new RegExp(",","g"),""),c,0,1),f=new CountUp("js-energy-state-percap",b("#js-energy-state-percap").html().replace(new RegExp(",","g"),""),d,0,1);e.start(),f.start();var g=[],h=0,i=r();for(var j in a.data)for(var k in i)g.push(Math.ceil(a.data[j]["per-capita"][i[k]]));h=Math.max.apply(Math,g),b("#js-energy-national-bar-x").css({width:Math.ceil(a.national.NATIONAL["per-capita"][a.year]/h*100)+"%"}),b("#js-energy-national-bar-y").css({height:Math.ceil(a.national.NATIONAL["per-capita"][a.year]/h*100)+"%"}),b("#js-energy-state-bar-x").css({width:Math.ceil(a.data[a.states[a.state].name.toUpperCase()]["per-capita"][a.year]/h*100)+"%"}),b("#js-energy-state-bar-y").css({height:Math.ceil(a.data[a.states[a.state].name.toUpperCase()]["per-capita"][a.year]/h*100)+"%"})}function m(c){-1==a.getuserAgent().toLowerCase().indexOf("msie")&&b("path",c).each(function(){var a=b(this)[0],c=a.getTotalLength();a.style.transition=a.style.WebkitTransition="none",a.style.strokeDasharray=c+" "+c,a.style.strokeDashoffset=c,a.getBoundingClientRect(),a.style.transition=a.style.WebkitTransition="stroke-dashoffset 2s ease-in-out",a.style.strokeDashoffset="0"})}function n(){var c=b("body").attr("data-theme-dir")+"/library/svgs/state-outlines/"+a.state.toLowerCase()+".svg";a.state!=b("#js-profile-state-outline").attr("data-state")&&(b("#js-profile-state-outline").empty(),b.get(c,function(c){document.createElement("div");b("#js-profile-state-outline").attr("data-state",a.state),b("#js-profile-state-outline").html((new XMLSerializer).serializeToString(c.documentElement)),m(b("#js-profile-state-outline"))}));var d,e,f,g,h=["total","coal","gas","oil","nuclear","renew"];for(d=0;d<h.length;d++)e=h[d],f=a.data[a.states[a.state].name.toUpperCase()].production["p_"+d],g=new CountUp("js-profile-"+e,b("#js-profile-"+e).html().replace(new RegExp(",","g"),""),f,0,1),g.start();var i=["residential","commercial","industrial","transportation"];for(d=0;d<i.length;d++)e=i[d],f=a.data[a.states[a.state].name.toUpperCase()]["end-user"]["e_"+d],g=new CountUp("js-profile-"+e,b("#js-profile-"+e).html().replace(new RegExp(",","g"),""),f,0,1),g.start();var j=[],k=0;for(var l in a.data)j.push(Math.ceil(a.data[l].production.p_4));k=Math.max.apply(Math,j),b("#js-profile-nuclear-bar").css({height:Math.ceil(a.data[a.states[a.state].name.toUpperCase()].production.p_4/k*100)+"%"})}function o(){var c=b("body").attr("data-theme-dir")+"/library/svgs/state-outlines/"+a.state.toLowerCase()+".svg",d=a.data[a.states[a.state].name.toUpperCase()]["per-source"][a.year].s_0;new CountUp("js-energy-total-value",b("#js-energy-total-value").html().replace(new RegExp(",","g"),""),d,0,1).start(),a.state!=b("#js-energy-state-outline").attr("data-state")&&(b("#js-energy-state-outline").empty(),b.get(c,function(c){document.createElement("div"),b("#js-energy-state-outline").attr("data-state",a.state),b("#js-energy-state-outline").html((new XMLSerializer).serializeToString(c.documentElement)),m(b("#js-energy-state-outline"))}))}function p(){var c=a.data[a.states[a.state].name.toUpperCase()]["per-source"][a.year][a.sector],d=a.national.NATIONAL["per-source"][a.year][a.sector],e=new CountUp("js-national-chart-value",b("#js-national-chart-value").html().replace(new RegExp(",","g"),""),c,0,1),f=new CountUp("js-national-chart-national",b("#js-national-chart-national").html().replace(new RegExp(",","g"),""),d,0,1);e.start(),f.start()}function q(){var c=b("#js-national-chart-disc .states g"),d=b("#js-national-chart-disc .current"),e=c.index(d),f=b('#js-national-chart-disc [data-state="'+a.state+'"]'),g=c.index(f),h=360*(e-g)/a.stateCodes.length;a.nationalChartRotation+=h,e-g!=0&&(h>180?a.nationalChartRotation-=360:h<-180&&(a.nationalChartRotation+=360)),b("#js-national-chart-disc").css({transform:"rotate("+a.nationalChartRotation+"deg)"}),d.removeClass("current"),f.addClass("current")}function r(){var b=[];for(var c in a.national.NATIONAL["per-source"])b.push(c);return b}function s(){b("a","#js-state-links").removeClass("selected"),b('a[data-state="'+a.state+'"]',"#js-state-links").addClass("selected"),b('option[value="'+a.state+'"]',"#js-select-state").prop("selected",!0)}function t(){b(".js-years").each(function(){var c=b(this);b("a",c).removeClass("selected"),b('a[data-year="'+a.year+'"]',c).addClass("selected")})}function u(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}a.loading=!1,a.nationalChartRotation=0,a.window=b(window),a.energyChart="",a.energyChartData=[],a.jumpToId=function(c,d,e){if(!a.loading){var f=b('[id="'+c+'"]');a.loading=!0,f.length>0&&b("html, body").animate({scrollTop:f.offset().top-d},800).promise().done(function(){"function"==typeof e&&e(),a.loading=!1})}},a.getNextYear=function(){var b=r(),c=b[0],d=b[b.length-1];return a.year==d?c:b[b.indexOf(a.year)+1]},a.getPrevYear=function(){var b=r(),c=b[0],d=b[b.length-1];return a.year==c?d:b[b.indexOf(a.year)-1]},a.getNextState=function(){var b=a.getCurrentState(),c=a.stateCodes[0],d=a.stateCodes[a.stateCodes.length-1];return b==d?c:a.stateCodes[a.stateCodes.indexOf(b)+1]},a.getPrevState=function(){var b=a.getCurrentState(),c=a.stateCodes[0],d=a.stateCodes[a.stateCodes.length-1];return b==c?d:a.stateCodes[a.stateCodes.indexOf(b)-1]},a.getCurrentState=function(){return a.state?a.state:"AL"},a.getCurrentSection=function(){return a.section?a.section:"national"},a.buildSections=function(){f(),j(),g(),d(300,300,200.5,a.stateCodes.length),h()},a.moveSection=function(){var c=b('.item[data-section="'+a.getCurrentSection()+'"]',"#js-section-nav");b(".item","#js-section-nav").removeClass("selected"),c.addClass("selected"),b("section:visible","#js-content-stage").hide(0,function(){b('[data-section="'+a.getCurrentSection()+'"]',"#js-content-stage").fadeIn(300)});var d=c.next(".item"),e=c.prev(".item");0===d.length&&(d=b(".item:first-of-type","#js-section-nav")),0===e.length&&(e=b(".item:last-of-type","#js-section-nav")),b("#js-section-nav-next").attr("data-section",d.attr("data-section")),b("#js-section-nav-prev").attr("data-section",e.attr("data-section")),a.window.trigger("resize"),b("#js-page-container").trigger("track-section-change")},a.populateSectionData=function(){s(),t(),i(),b(".js-state-title").html(a.states[a.state].name),b("#js-section-national").is(":visible")&&(q(),k(),p()),b("#js-section-energy").is(":visible")&&(e("#js-energy-chart-canvas"),l(),o()),b("#js-section-profile").is(":visible")&&n()},a.showStateSummary=function(){var c=b("#js-state-summary-template").html().replace(new RegExp(",","g"),"");b("#js-state-summary-text").html(c),b("#js-state-summary").fadeIn(300),b.ajax({method:"GET",url:"/?p_ajax="+a.states[a.state].id}).done(function(a){b("#js-state-summary-text").html(a)})},a.hideStateSummary=function(){b("#js-state-summary").fadeOut(300,function(){b("#js-state-summary-text").empty()})},a.showFootnotes=function(){var c=b("#js-footnotes-template").html().replace(new RegExp(",","g"),"");b("#js-footnotes-text").html(c),b("#js-footnotes").fadeIn(300),b.ajax({method:"GET",url:"/?f_ajax="+a.section}).done(function(a){b("#js-footnotes-text").html(a)})},a.hideFootnotes=function(){b("#js-footnotes").fadeOut(300,function(){b("#js-footnotes-text").empty()})},a.getuserAgent=function(){var a=navigator.userAgent;return-1!==navigator.userAgent.indexOf("Trident")&&(a+=" MSIE 11"),a}}(window.EIU=window.EIU||{},jQuery),$(function(){"use strict";document.documentElement.setAttribute("data-useragent",EIU.getuserAgent()),FastClick.attach(document.body),jQuery.fx.interval=30,$("#js-page-container").on("click",".js-scroll",function(a){var b=0;$(this).attr("data-offset")&&(b=$(this).attr("data-offset")),EIU.jumpToId($(this).attr("href").split("#")[1],b),a.preventDefault()}),$("#js-state-nav").length>0&&(EIU.buildSections(),EIU.moveSection(),EIU.populateSectionData());var a=EIU.window.width();EIU.window.on("resize",function(){(EIU.window.width()<767&&a>767||EIU.window.width()>767&&a<767)&&($("#js-energy-chart-canvas").empty(),EIU.populateSectionData(),a=EIU.window.width())}),$("#js-page-container").on("click","#js-national-chart-disc .states > g",function(){EIU.state=$(this).attr("data-state"),EIU.populateSectionData()}),$("#js-page-container").on("click",".js-nav-year-next",function(a){EIU.year=EIU.getNextYear(),EIU.populateSectionData(),a.preventDefault(),$("#js-page-container").trigger("track-year-change")}),$("#js-page-container").on("click",".js-nav-year-prev",function(a){EIU.year=EIU.getPrevYear(),EIU.populateSectionData(),a.preventDefault(),$("#js-page-container").trigger("track-year-change")}),$("#js-page-container").on("click",".js-nav-state-next",function(a){EIU.state=EIU.getNextState(),EIU.populateSectionData(),a.preventDefault(),$("#js-page-container").trigger("track-state-change")}),$("#js-page-container").on("click",".js-nav-state-prev",function(a){EIU.state=EIU.getPrevState(),EIU.populateSectionData(),a.preventDefault(),$("#js-page-container").trigger("track-state-change")}),$("#js-state-links").on("click","a",function(a){$(this).hasClass("selected")||(EIU.state=$(this).attr("data-state"),EIU.populateSectionData(),$("#js-page-container").trigger("track-state-change")),a.preventDefault()}),$("#js-page-container").on("click",".js-years a",function(a){$(this).hasClass("selected")||(EIU.year=$(this).attr("data-year"),EIU.populateSectionData(),$("#js-page-container").trigger("track-year-change")),a.preventDefault()}),$("#js-page-container").on("change",".js-select-state",function(a){EIU.state=$(this).val(),EIU.populateSectionData(),$("#js-page-container").trigger("track-state-change")}),$("#js-page-container").on("change","#js-select-sector",function(a){if(""===$(this).val())return!1;EIU.sector=$(this).val(),EIU.populateSectionData()}),$("#js-page-container").on("click",".js-launch-summary",function(a){EIU.showStateSummary(),a.preventDefault()}),$("#js-page-container").on("click",".js-close-summary",function(a){EIU.hideStateSummary(),a.preventDefault()}),$("#js-page-container").on("click",".js-launch-footnotes",function(a){EIU.showFootnotes(),a.preventDefault()}),$("#js-page-container").on("click",".js-close-footnotes",function(a){EIU.hideFootnotes(),a.preventDefault()}),$("#js-page-container").on("click",".js-section-nav",function(a){$(this).hasClass("selected")||(EIU.section=$(this).attr("data-section"),EIU.hideStateSummary(),EIU.hideFootnotes(),EIU.moveSection(),EIU.populateSectionData()),a.preventDefault()});var b="";$(".js-state-title","#js-section-energy, #js-section-profile").each(function(){b=new Hammer($(this)[0]),b.on("swipeleft",function(a){EIU.state=EIU.getNextState(),EIU.populateSectionData()}),b.on("swiperight",function(a){EIU.state=EIU.getPrevState(),EIU.populateSectionData()})}),$(".js-year-links").each(function(){b=new Hammer($(this)[0]),b.on("swipeleft",function(a){EIU.year=EIU.getNextYear(),EIU.populateSectionData()}),b.on("swiperight",function(a){EIU.year=EIU.getPrevYear(),EIU.populateSectionData()})}),b=new Hammer($("#js-section-nav")[0]),b.on("swipeleft",function(a){$("#js-section-nav-next").trigger("click")}),b.on("swiperight",function(a){$("#js-section-nav-prev").trigger("click")}),b=new Hammer($("#js-national-chart")[0]),b.on("swipeleft",function(a){EIU.state=EIU.getNextState(),EIU.populateSectionData()}),b.on("swiperight",function(a){EIU.state=EIU.getPrevState(),EIU.populateSectionData()})}),function(a,b,c){a.sendTrackingEvent=function(a,b,c){ga("send","event",a,b,c)}}(window.EIU=window.EIU||{},jQuery);var container=$("#js-page-container");container.on("click",".ga-header-logo",function(){EIU.sendTrackingEvent("header-eiu-logo","external-link","")}),container.on("click",".ga-header-sponsor",function(){EIU.sendTrackingEvent("header-chevron-sponsor-logo","external-link","")}),container.on("click",".ga-footer-about",function(){EIU.sendTrackingEvent("footer-link-about-us","open-content-external","")}),container.on("click",".ga-footer-eiu",function(){EIU.sendTrackingEvent("footer-link-Economist-Intelligence-Unit","open-content-external","")}),container.on("click",".ga-footer-conferences",function(){EIU.sendTrackingEvent("footer-link-Economist-Conferences","open-content-external","")}),container.on("click",".ga-footer-access",function(){EIU.sendTrackingEvent("footer-link-accessibility","open-content-external","")}),container.on("click",".ga-footer-privacy",function(){EIU.sendTrackingEvent("footer-link-privacy-policy","open-content-external","")}),container.on("click",".ga-footer-economist",function(){EIU.sendTrackingEvent("footer-link-The-Economist-online","open-content-external","")}),container.on("click",".ga-footer-contact",function(){EIU.sendTrackingEvent("footer-link-contact-us","open-content-external","")}),container.on("click",".ga-footer-group",function(){EIU.sendTrackingEvent("footer-The-Economist-Group","open-content-external","")}),container.on("click",".ga-footer-eiu-logo",function(){EIU.sendTrackingEvent("footer-The-Economist-Intelligence-Unit-Logo","open-content-external","")}),container.on("click",".ga-shares a",function(){var a=$(this).attr("title").toLowerCase();EIU.sendTrackingEvent("social-media-shares",a+"-share",$("#ga-share-title").val())}),container.on("click",".ga-footer-channels a",function(){var a=$(this).attr("title").toLowerCase();EIU.sendTrackingEvent("open-social-external",a,"")}),container.on("click",".ga-footer-email",function(){EIU.sendTrackingEvent("footer-email-share","Home","")}),container.on("track-section-change",function(){EIU.sendTrackingEvent(EIU.section+"-view","view-selected",EIU.states[EIU.state].name),ga("send","pageview","/"+EIU.section+"/"+EIU.states[EIU.state].name)}),container.on("track-state-change",function(){EIU.sendTrackingEvent(EIU.section+"-view","state-selected",EIU.states[EIU.state].name),ga("send","pageview","/"+EIU.section+"/"+EIU.states[EIU.state].name)}),container.on("track-year-change",function(){EIU.sendTrackingEvent(EIU.section+"-view",EIU.year,EIU.states[EIU.state].name)}),container.on("change",".ga-select-sector",function(){EIU.sendTrackingEvent(EIU.section+"-view",EIU.labels[$(this).val()],EIU.states[EIU.state].name)}),container.on("click",".ga-view-profile",function(){EIU.sendTrackingEvent(EIU.section+"-view","view-state-profile",EIU.states[EIU.state].name)}),container.on("click",".ga-view-footnotes",function(){EIU.sendTrackingEvent(EIU.section+"-view","additional-notes-button",EIU.states[EIU.state].name)});
//# sourceMappingURL=main.min.js.map